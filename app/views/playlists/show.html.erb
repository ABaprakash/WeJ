Requests remaining: <%= @votes_remaining %>
<div id="<%= @playlist.id %> search-div">
  <form action="/spotify" method="POST" name='search' id="search-form">
    <input type="search" name="query" id="search-box" placeholder="Start typing a song...">
    <button type='submit' id="song-submit-button">Request</button>
  </form>
<div id="search-results">
</div>
</div>
<% @playlistsongs.each do |playlistsong| %>
  <% if playlistsong.id == @playlist.currently_playing_song %>
    <div class="currently-playing"><p><strong><%= playlistsong.song.title %></strong></p></div>
  <% else %>
    <p><%= playlistsong.song.title %></p>
  <% end %>
  <% unless playlistsong.has_been_played || current_user.votes.where(playlistsong_id: playlistsong.id).count >= 1 %>
    <% unless @votes_remaining <= 0 %>
      <%= form_for playlistsong, url: {controller: "votes", action: "create", id: playlistsong.id}, method: :post do |f| %>
        <%= hidden_field_tag 'user_id', current_user.id %>
        <%= hidden_field_tag 'request_type', 'vote' %>
        <%= f.submit "vote" %>
      <% end %>
    <% end %>
    <%= form_for playlistsong, url: {controller: "votes", action: "create", id: playlistsong.id}, method: :post do |f| %>
      <%= hidden_field_tag 'user_id', current_user.id %>
      <%= hidden_field_tag 'request_type', 'flag' %>
      <%= f.submit "flag" %>
    <% end %>
  <% end %>
<% end %>


<%= if @errors %>
  <div class="modal fade" id="myModal" role="dialog">
    <div class="modal-dialog">
    
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-body">
          <p><%= @errors %></p>
        </div>

        <div class="modal-footer">
          <button type="button" class="btn btn-primary btn-sm" data-dismiss="modal">Okay</button>
        </div>
      </div>
      
    </div>
  </div>
<% end %>
